# 计算机操作系统

## 基本概念

并发和并行：

- **并发**：宏观上在一段时间内能同时运行多个程序，通常多个线程同时在访问同一个资源
- **并行**：同一时刻能运行多个指令，之后再汇总任务结果

共享：

- **互斥共享**：资源（被称为**临界资源**）在同一时刻只允许一个进程访问，需要同步机制
- **同时共享**：资源在同一时刻允许多个进程访问

虚拟：物理实体---*(虚拟技术)*--->多个逻辑实体

- **时分复用技术**：时分复用技术让每个进程轮流占用处理器，每次只执行一小个时间片并快速切换
- **空分复用技术**：虚拟内存使用了空分复用技术，将物理内存抽象为进程独享的地址空间

**异步**：进程不是一次性执行完毕

操作系统的基本功能：

1. 进程管理
2. 内存管理
3. 文件管理
4. 设备管理

**系统调用**：用户态---*(系统调用)*--->内核态

Linux的系统调用：

1. 进程控制
2. 进程通信
3. 文件操作
4. 设备操作
5. 信息维护
6. 安全

内核结构分类：

- **宏内核**：操作系统主要功能作为一个整体作为内核
  - 优点：高性能
  - 缺点：结构庞大，难以维护
- **微内核**：只保留基本功能在内核
  - 优点：结构简单，便于维护
  - 缺点：频繁在用户态和内核态之间切换，性能低
- **混合内核**：宏内核 + 微内核

中断分类：

1. **外中断**：如I/O中断、时钟中断、控制台中断等
2. **异常**：CPU内部异常，如非法操作码、地址越界、算术溢出等
3. **陷入**：在用户程序中使用系统调用





## 进程管理

**PCB**（Process Control Block）：即**进程控制块**，描述进程的基本信息和运行状态，所谓的创建进程和撤销进程，都是指对 PCB 的操作



### 进程状态模型

进程三态模型：

![](计算机操作系统.assets/process-three-states.png)

进程五态模型：

![](计算机操作系统.assets/process-five-states.png)



### 进程调度算法

- 批处理系统：传统大、中型计算机
  1. **先来先服务**（FCFS）
  2. **短作业优先**（SJF）
  3. **最短剩余时间优先**（SRTN）
- 交互式系统（分时操作系统）：如Linux
  1. **时间片轮转**：所以就绪进程组成一个队列FCFS，每次执行一个时间片
  2. **优先级调度**：为每个进程分配一个优先级，等待越久的优先级越高
  3. **多级反馈队列**：维护多个时间片大小不同的队列，时间片最小的优先级越高，可以看成时间片轮转 + 优先级调度的结合
- 实时系统
  1. 硬实时：满足截止时间
  2. 软实时：可以一定地超时



### 进程同步

**临界区**：对临界资源进行访问的那段代码

同步与互斥：

- 同步：多个进程之间因为合作产生的制约关系
- 互斥：多个进程在同一时刻只有一个进程能进入临界区



**信号量**：一个整型变量，大于等于0，等于0则阻塞

down和up操作都是**原语**（不可分割的操作）

- down：-1
- up：+1

信号量可以用来实现管程



**管程**：通过条件变量 `condition` 和 `wait()` 、`signal()` 操作来实现同步